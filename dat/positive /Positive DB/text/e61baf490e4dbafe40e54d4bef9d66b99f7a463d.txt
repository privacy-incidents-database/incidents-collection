Criminal Software, Government-Grade Protection - The New York Times
The arms race between criminal hackers and targeted companies just became a little more military, with serious implications for business.
Researchers at a software security company say they have found a popular type of criminal software inside an extremely sophisticated evasion code, which they say was previously used by Russia to spy on one or more Eastern European governments.
The evasion software, written in a painstaking way to avoid most conventional detection methods, was most likely detached from its original program and sold to a criminal gang by someone in Russian intelligence, the company said.
Nonetheless, the finding underlines the increasing difficulty in extracting from a malware attack whether the assailant is government, criminal or simply malicious. Likewise, categories among targets, like military or business, are also blurred.
This is a very fresh product, very expensive to use, said Tomer Weingarten, the co-founder and chief executive of Sentinel Labs, a Mountain View, Calif., company that announced the discovery. Even if they caught the malware, it would be hard to know how it got in your system.
The researchers named the malware Gyges, after the ring of Gyges in Greek mythology. Wearing the ring made its owner invisible.
Sentinel, which published its findings in a white paper, said it initially discovered the malicious software in March, in the systems of one of its customers. Mr. Weingarten declined to name the company, but said it was in the technology industry. Since then, three more variants of the malware have been found.
The payload delivered by Gyges is so-called ransomware, in which typically a computer is shut down and its data encrypted. The attacker then threatens to destroy the data unless the computers owner pays up. With a good infection rate, its a very cost-effective thing to do, Mr. Weingarten said.
Ordinarily such software, which is commonly sold in online black markets, is discovered by conventional security methods, such as running the program through a sandbox, or isolated computing environment, before letting it touch a main system.
In this case, the evasion code in which the ransomware was nested was written in such a way that it could detect a virtual environment, as opposed to the real thing. It also appeared to have been written directly in assembly code, a painstaking method that made it harder to detect and understand.
I assume this took lots of guys and thousands of hours, said Udi Shamir, the head of research at Sentinel. Its really hard to reverse-engineer how this works. Going through conventional antivirus software, it would be marked benign.
Mr. Shamir said that after looking at Gyges a long time, he doubted the Russian government was directly responsible for the release of its sophisticated code. A few thousand dollars, in Russia thats a lot of money. I dont think Russian intelligence would want to sell something like this.
Such malware reports are usually issued both to alert the law-abiding community and to advertise the prowess of the company publishing the findings. Sentinels report is no exception.
Sentinels software works by putting lightweight agents on top of new applications that come into a computing system, then watching, sometimes for days, for suspicious patterns. Once the suspicious activity crosses a threshold, Sentinel isolates the application so it cannot do further harm.
In the case of Gyges, Mr. Weingarten said, Sentinel first detected behavior between benign and malicious from the evasion code, but did not really see a problem and isolate the malware until the ransomware began to operate.
At that point, we started looking at the carrier code, and looking for similarities, Mr. Weingarten said. The ones we found were with government-grade software.
Like much corporate software, black market malware is increasingly sold online in bulk, leading to the term malware as a service. Typically these build it yourself products are older versions of malware, and well known by security researchers. Whoever has Gyges, Mr. Shamir said, probably will not offer it to criminals on a broad basis anytime soon, since it is too valuable on its own.
It took me hours, days to understand this, he said. Its really efficient, professional code. You wouldnt want to morph it and scale it out as a service.
Visit the Technology section for complete coverage of the industry. 
